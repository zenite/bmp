<!--框架协议审批流程-->
<fm-form-title sn-number="{{base.snNumber}}" apply-date="{{base.applyDate}}" sub-title='base.title' fm-model="base.areaCode"></fm-form-title>
<!--<fm-Group-Head class="print-hide" title="{{ base.$pageLang.PostByInfo }}"></fm-Group-Head>
<fm-initiator class="print-hide" jobid='base.jobId' userinfo='base.initiator' taskid='base.taskId'></fm-initiator>-->
 
<!--申请人信息-->
<fm-Group-Head class="print-hide" title="{{ base.$pageLang.ApplicantInfo }}"></fm-Group-Head>

<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--申请人名字-->
            <span class="col-xs-2 control-label">{{ "ApplicantName" | translate }}</span>
            <div class="col-xs-4">
                <div class="input-group" style="width: 100%;">
                    <span class="form-label">{{base.applicant.userName}}</span>
             <!--       <span class="input-group-btn" ng-if="!taskid">
                        <button class="btn btn-default" type="button" ng-click="base.$selectApplicant()">{{ "Choose" | translate }}</button>
                    </span>-->
                </div>
            </div>
            <!--申请人员工号-->
            <span class="col-xs-2 control-label">{{ "ApplicantEmployeeNumber" | translate }}</span>
            <div class="col-xs-4"><span class="form-label">{{base.applicant.employeeNumber}}</span></div>
        </div>
    </div>
    <div class="form-group">
        <!--申请人部门线-->
        <div class="col-xs-12">
            <span class="col-xs-2 control-label">{{ "ApplicantDepartment" | translate }}</span>
            <div class="col-xs-10"><span class="form-label">{{base.applicant.departmentName}}</span></div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-xs-12">
            <!--申请人电话-->
            <span class="col-xs-2 control-label">{{ "ApplicantContactNumber" | translate }}</span>
            <div class="col-xs-4"><span class="form-label">{{base.applicant.contactNumber}}</span></div>
            <!--申请人邮箱-->
            <span class="col-xs-2 control-label">{{ "ApplicantEmail" | translate }}</span>
            <div class="col-xs-4"><span class="form-label">{{base.applicant.emailAddress}}</span></div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-xs-12">
            <!--申请人手机-->
            <span class="col-xs-2 control-label">{{ "ApplicantMobileNumber" | translate }}</span>
            <div class="col-xs-4"><span class="form-label">{{base.applicant.mobileNumber}}</span></div>
            <!--申请人直属领导-->
            <span class="col-xs-2 control-label">{{ "ApplicantDirectManager" | translate }}</span>
            <div class="col-xs-4"><span class="form-label">{{base.applicant.directManagerName}}</span></div>
        </div>
    </div>
</div>
<!--<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <span class="col-xs-2 control-label">{{ form.$pageLang.Mobile}}</span>
            <div class="col-xs-4"><span class="form-label">1111</span></div>
            <span class="col-xs-2 control-label">{{ form.$pageLang.DirectManager}}</span>
            <div class="col-xs-4"><span class="form-label">1111</span></div>
            </div>
        </div>
    </div>
</div>-->
<fm-Group-Head title="{{ form.$pageLang.SuppulierInformation }}"></fm-Group-Head>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--供应商代码-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.SupplierCode"></span>
            <div class="col-xs-4">
                <fm-data-select view="GetAllSupplierInfoFilter"
                                field-name="{{form.$pageLang.SupplierCode}}"
                                required  
                                 Size="lg"
                                state="{{form.$pageRight.StartNode}}"
                                callback-func="form.chooseSupplierInfo(selectItem)"
                                fm-model="form.pur15.supplierCode"
                                fm-placeholder="{{form.$pageLang.DropdownSelection}}"></fm-data-select>
            </div>
            <!--采购-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.Buyer"></span>
            <div class="col-xs-4">
                <fm-select field-name="{{form.$pageLang.Buyer}}"
                           required
                           state="{{form.$pageRight.StartNode}}"
                           view="GetBuyer"
                           fm-model="form.pur15.buyer"></fm-select>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--供应商名称-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.SupplierName"></span>
            <div class="col-xs-4">
                <fm-text  class="input-sm" readonly fm-model="form.pur15.supplierName"></fm-text>
            </div>
            <!--协议类型-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.Type"></span>
            <div class="col-xs-4">
                <fm-select field-name="{{form.$pageLang.Type}}"
                           required
                           state="{{form.$pageRight.StartNode}}"
                           dataitem="PurchaseRelated>FrameworkAgreementData>ProtocolType"
                           fm-model="form.pur15.type"></fm-select>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--协议生效日期-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.StartEffective"></span>
            <div class="col-xs-4">
                <fm-datetime field-name="{{form.$pageLang.StartEffective}}"
                             date
                             state="{{form.$pageRight.StartNode}}"
                             required
                             fm-model="form.pur15.startEffective" 
                             fm-placeholder="{{form.$pageLang.DropdownSelection}}"></fm-datetime>
            </div>
            <!--协议结束日期-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.EndEffective"></span>
            <div class="col-xs-4">
                <fm-datetime field-name="{{form.$pageLang.EndEffective}}"
                             date
                             state="{{form.$pageRight.StartNode}}"
                             required
                             fm-model="form.pur15.endEffective" 
                             fm-placeholder="{{form.$pageLang.DropdownSelection}}"></fm-datetime>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--使用部门-->
            <span class="col-xs-2 control-label required  " ng-bind="form.$pageLang.prDept"></span>
            <div class="col-xs-10">
                <fm-data-select ismulti 
                                field-name="{{form.$pageLang.prDept}}"
                                state="{{form.$pageRight.StartNode}}"  
                                group fm-model="form.pur15.prDept"
                                required></fm-data-select>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--用途-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.Description"></span>
            <div class="col-xs-10">
                <fm-textarea required  max-length="1000"
                             items="[]" 
                             state="{{form.$pageRight.StartNode}}"
                             field-name="{{form.$pageLang.Description}}"
                             fm-model="form.pur15.description"></fm-textarea>
            </div>
        </div>
    </div>
</div>
 
<div class="row">
    <div class="col-xs-12">
        <table class="table table-bordered table-detail">
            <thead>
                <tr>
                    <th  style="width:30px; text-align:center;"  class="checktd" >
                        <input type="checkbox" class="uniform" 
                               ng-checked="form.pur15dAllChecked" 
                               ng-model="form.pur15dAllChecked" 
                               ng-click="form.$checkAll(form.pur15dAllChecked, form.pur15d)" /> 
                    
                    </th> <!--标记-->
                    <th style="width:40px;text-align:center;" ng-bind="form.$pageLang.No"></th> <!--序列-->
                    <th style="width:170px;text-align:center;" class="required" ng-bind="form.$pageLang.Product"></th> <!--品名-->
                    <th style="width:170px;text-align:center;" ng-bind="form.$pageLang.ProductionDescription"></th> <!--品名描述-->
                    <th style="width:170px;text-align:center;" class="required" ng-bind="form.$pageLang.Currency"></th> <!--币种-->
                    <th style="width:170px;text-align:center;" class="required" ng-bind="form.$pageLang.Tax"></th> <!--是否含税-->
                    <th ng-if="form.pur15.last=='1'" style="width:170px;text-align:center;" ng-bind="form.$pageLang.LastYearuUnitPrice"></th> <!--上一版单价-->
                    <th style="width:150px;text-align:center;" class="required" ng-bind="form.$pageLang.Price"></th> <!--单价-->
                </tr>
                </thead>
            <tbody>
                <tr ng-repeat="item in form.pur15d" ng-class="{ 'active': item.checked}" detail-name="{{form.$pageLang.Fare}}">
                    <td class="checktd">
                        <input class="uniform"
                               ng-if="base.pageState==1 || (form.$pageRight.StartNode == 'normal' && base.pageState==2) "
                               type="checkbox" ng-model="item.checked" />
                    </td>
                    <td>
                        <fm-number ng-if="item.gridOrder!=null" class="input-sm"
                                   fm-model="item.gridOrder"></fm-number>
                        <span ng-if="item.gridOrder == null">{{$index + 1}}</span>
                    </td>
                    <td>
                        <fm-text field-name="{{form.$pageLang.Product}}"
                                 required class="input-sm"  detail
                                 state="{{form.$pageRight.StartNode}}"
                                 fm-model="item.product"></fm-text>
                    </td>
                    <td>
                        <fm-text field-name="{{form.$pageLang.ProductionDescription}}"
                                 class="input-sm" detail
                                 state="{{form.$pageRight.StartNode}}"
                                 fm-model="item.productionDescription"></fm-text>
                    </td>
                    <td>
                        <fm-select field-name="{{form.$pageLang.Currency}}" 
                                   class="input-sm"  detail
                                   view="GetCurrency" 
                                   required  style="background-color:white;"
                                    state="{{form.$pageRight.StartNode}}"
                                   fm-model="item.currency"></fm-select>
                    </td>
                    <td>
                        <fm-select field-name="{{form.$pageLang.Tax}}"
                                   dataitem="Common>YesOrNo"  
                                   class="input-sm"  detail
                                   required style="background-color:white;"
                                   state="{{form.$pageRight.StartNode}}"
                                   fm-model="item.tax"></fm-select>
                    </td>
                   <td ng-if="form.pur15.last=='1'">
                        <fm-text    field-name="{{form.$pageLang.LastYearuUnitPrice}}"
                                 class="input-sm"
                                 readonly detail
                                 state="{{form.$pageRight.StartNode}}"
                                 fm-model="item.lastyearunitprice"></fm-text>
                    </td>
                    <td>
                        <fm-number field-name="{{form.$pageLang.Price}}"
                                 class="input-sm"
                                 required  
                                 cny detail
                                 state="{{form.$pageRight.StartNode}}"
                                 fm-model="item.price"></fm-number>
                    </td>
                </tr>

            </tbody>
            <tfoot>
                <tr>
                    <td colspan="99" style="text-align:left;"> 
                            <table style="width:100%;">
                                <tr> 
                                    <td style="text-align:right;border:0px;">
                                        <fm-import-advance config="form.import"
                                                           ng-if="form.$pageRight.StartNode == 'normal' &&base.pageState!=3 "
                                                           form-files="form.$attachments"
                                                           link-id="2"
                                                           task-id='base.taskId'
                                                           callback-func="form.importD(importData)"></fm-import-advance>
                                    </td>

                                    <td style="text-align:right;border:0px;width:10%;"> 
                                        <!--<fm-import-xls ng-if="form.$pageRight.StartNode == 'normal'&&base.pageState!=3"
                                                       template="/AppPages/Workflow/pur/pur15_a12e07c76d2c412ea0a47a21746c26fc/Template.xls"
                                                       start-index="0"
                                                       columns="['product','productionDescription','currency','tax','price']"
                                                       callback-func="form.getlength(data)"></fm-import-xls>-->
                                        <input ng-if="form.$pageRight.StartNode == 'normal' &&base.pageState!=3 " type="button" class="btn btn-sm btn-info" ng-click="form.pur15d.push({})" value="{{ 'Add' |translate}}" />
                                        <input ng-if="form.$pageRight.StartNode == 'normal' &&base.pageState!=3  " type="button" class="btn btn-sm btn-danger" ng-click="form.delete()" value="{{ 'Delete' |translate}}" />
                                    </td>
                                </tr>
                            </table>  
                    </td>
                </tr>
            </tfoot>
           
        </table>
    </div>
</div>
<fm-Group-Head title="{{ form.$pageLang.SelectApprover }}"></fm-Group-Head>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--使用部门经理/总监-->
            <span class="col-xs-2 control-label required " ng-bind="form.$pageLang.prdm"></span>
            <div class="col-xs-10">
                <fm-job-select required  state="{{form.$pageRight.StartNode}}"   field-name="{{form.$pageLang.prdm}}"  ismulti fm-model="form.pur15.deptManager"></fm-job-select>
                <!--<fm-data-select  
                                field-name="{{form.$pageLang.PRDM}}"
                                fm-model="form.pur15.deptManager"></fm-data-select>-->
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="form-group">
        <div class="col-xs-12">
            <!--子公司相关经理-->
            <span class="col-xs-2 control-label "    ng-bind="form.$pageLang.SubManager"></span>
            <div class="col-xs-10">

                <fm-job-select state="{{form.$pageRight.StartNode}}"   ismulti fm-model="form.pur15.subManager"></fm-job-select>
            </div>
        </div>
    </div>
</div>
<!--附件-->
<fm-Group-Head class="print-hide" title="{{ 'Attachment' |translate}}"></fm-Group-Head>
<div class="print-hide row">
    <div class="form-group">
        <div class="col-xs-12">
          
            <div class="col-xs-12">
                <!--<fm-attachment form-files="form.$attachments"
                                link-id="0"
                                task-id='base.taskId'
                                node-id="base.nodeId"
                                draft-id="base.draftId"
                                required
                                state="{{form.$pageRight.StartNode}}"
                                field-name="{{'UploadAttachment' |translate}}"
                                fm-model="form.$state.UploadAttachment"
                                button-name="{{ 'UploadAttachment' |translate}}"></fm-attachment>-->
                <fm-attachment class="print-hide" form-files="form.$attachments"
                               state="{{form.$pageRight.StartNode}}"
                               link-id="1"
                               task-id='base.taskId'
                               node-id="base.nodeId"
                               draft-id="base.draftId"
                               button-name="{{ 'UploadAttachment' |translate}}"></fm-attachment>
            </div>
        </div>
    </div>
</div>
